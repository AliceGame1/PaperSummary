### 硬阈值估计器与L0正则

### 问题定义

给定一个向量 $x \in \mathbb{R}^n$ 和一个正则化参数 $\lambda > 0$，我们需要解决以下优化问题：

$$
\arg\min_{f \in \mathbb{R}^n} \frac{1}{2} \|f - x\|^2_2 + \lambda \|f\|_0
$$

其中，$\|f\|_0$ 表示向量 $f$ 中非零元素的个数。

### 逐元素分析

由于目标函数是逐元素可分的（即可以写成 $\sum_{i=1}^n g(f_i)$ 的形式），我们可以分别对每个元素 $f_i$ 进行优化。对于每个 $i$，我们考虑以下标量优化问题：

$$
\arg\min_{f_i} \frac{1}{2} (f_i - x_i)^2 + \lambda \mathbf{1}_{\{f_i \neq 0\}}
$$

其中，$\mathbf{1}_{\{f_i \neq 0\}}$ 是一个指示函数，当 $f_i \neq 0$ 时为 1，否则为 0。

### 求解标量优化问题

1. **当 $f_i = 0$ 时**：
   目标函数值为 $\frac{1}{2} x_i^2$（因为 $(f_i - x_i)^2 = x_i^2$ 且 $\lambda \mathbf{1}_{\{f_i \neq 0\}} = 0$）。

2. **当 $f_i \neq 0$ 时**：
   目标函数变为 $\frac{1}{2} (f_i - x_i)^2 + \lambda$。这是一个关于 $f_i$ 的二次函数，其最小值出现在 $f_i = x_i$（因为二次项系数为正，函数开口向上，最小值出现在对称轴上）。此时，目标函数值为 $\lambda$。

### 比较两种情况

我们需要比较这两种情况下的目标函数值，以确定 $f_i$ 的最优值。

- 如果 $\frac{1}{2} x_i^2 \leq \lambda$，则设置 $f_i = 0$ 会使目标函数值更小。
- 如果 $\frac{1}{2} x_i^2 > \lambda$，则设置 $f_i = x_i$ 会使目标函数值更小。

### 硬阈值估计器

综合以上分析，我们可以得出硬阈值估计器的形式：

$$
\tilde{f}_i = \begin{cases}
0 & \text{if } \frac{1}{2} x_i^2 \leq \lambda \\
x_i & \text{if } \frac{1}{2} x_i^2 > \lambda
\end{cases}
$$

但通常，硬阈值估计器会基于 $|x_i|$ 的大小来决定是否将 $f_i$ 设为 0，因为平方和绝对值在判断元素是否“重要”时是等价的（在这里，“重要”意味着不应被阈值化为 0）。因此，更常见的形式是：

$$
\tilde{f}_i = \begin{cases}
0 & \text{if } |x_i| \leq \sqrt{2\lambda} \\
x_i & \text{if } |x_i| > \sqrt{2\lambda}
\end{cases}
$$

这样，我们就得到了硬阈值估计器的完整形式。
